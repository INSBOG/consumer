import pandas as pd
from io import BytesIO
from services.validator import ValidatorService

report = {
		"_id": "6851e65f7a7f2607d6612583",
		"date": "2025-06-17 17:04:15.935000",
		"filename": "1d2f4ec1-d554-4654-8bc3-9c10116227bb.xlsx",
		"department": "678066c0b0b7cf07de5d9795",
		"month": "2025-01",
		"user": "66f2e82be1b52232c6678f2c",
		"original_filename": "ANT_ene_2025.xlsx",
		"status": 1,
		"progress": 0,
		"usr": {
			"_id": "66f2e82be1b52232c6678f2c",
			"username": "dbocanegra",
			"name": "Daniela Bocanegra",
			"email": "danibomon@gmail.com",
			"admin": False,
			"temp_password": False,
			"password_exp": 1750989062.269572,
			"password_history": [
				{
					"date": "2024-09-25 16:34:30",
					"password": "$2b$12$SjdFQmkY/omzKbNnUVSdN.jeLClZhVhlJ616Uyy6CLPbe1R9Dgj9y"
				},
				{
					"date": "2024-11-17 15:21:17",
					"password": "$2b$12$CC4jDuVccpZi0i073UJVLubTvoNnw7/RZWjog.rb7L1jZb4pepiuG"
				},
				{
					"date": "2025-01-10 14:10:34",
					"password": "$2b$12$PZRmynNqu5wTmkHPPIGRK.VQsCpgcm8AfXg5pJd9LPjT5VQKRs3Pq"
				},
				{
					"date": "2025-01-17 10:06:06",
					"password": "$2b$12$k.mhudgahDVHuuBrjgbwOOC/QtrG1sIc.PxwsCb.U41C//IKH9wCq"
				},
				{
					"date": "2025-02-24 09:08:02",
					"password": "$2b$12$nQxBK95NLNoUobQ0M9bHU.v4Wvn0X1OdCKxAgHECTrLX9weQMxaXi"
				},
				{
					"date": "2025-04-29 00:20:12",
					"password": "$2b$12$Sd.UTrNCYYiZ.hqp5mvRI.d.nT/7ydbdU4DfHBNzAiRjoL7XyxAJm"
				},
				{
					"date": "2025-05-27 20:51:02",
					"password": "$2b$12$bdoLTzweNH2tgX3K1QVrEevKHM4CtYOA9THdbqqFJxd2mwiVsXiJa"
				}
			],
			"challenge": "b'\\xda\\x89U\\xb7\\x122_\\x8d>G\\x8a\\xaat\\xc5\\x18<\\x9b\\xd87S\\x9b\\xa13\\x1f\\xd5\\xaa\\xb3\\xb9!\\xde$\\x1e\\x00\\xf2\\xed\\x02\\x85m\\x11(\\x9d\\xa3\\x08\\xdf\\x8e<\\xa6\\x89o\\x15]\\xe7\\xf2\\xbc\\x1ew\\xf5\\xcd\\x8e\\xae\\r\\x91\\x8dA'",
			"credential_id": "b'M\\xd5\\x05\"\\xa4\\xea`Wv\\xa8\\xe6\\xa4\\xb5.\\xad\\xc7\\\\\\x96\\xf1m'",
			"public_key": "b'\\xa5\\x01\\x02\\x03& \\x01!X Y\\x89\\x8b\\x890+A\\xf7\\xea\\x1f\\xd2\\xe2\\xf0\\xa3\\x96pa\\x93Q\\xf6\\xad\\x8e\\x1d\\xac;\\x1d\\xden\\x02\\xa0\\x8bJ\"X \\x9c\\xfd\\x83\\x85\\x87C\\xd3\\xfa\\xc8\\t\\xbc\\xca\\xcfdD?)h\\xa0y\\x0b~H\\xc7\\x12\\x0f*v/}\\x90\\x89'"
		},
		"dpto": {
			"dpto": "Antioquia",
			"values": [
				"1/2ad1-inx",
				"pen-inx",
				"piso 6-inx",
				"piso 7-inx",
				"pri-inx",
				"quemad-inx",
				"quempe-inx",
				"pedt4-inx",
				"qxgine-inx",
				"recinf-inx",
				"recpol-inx",
				"s.part-inx",
				"s.qx-inx",
				"sanbla-inx",
				"sancam-inx",
				"recard-inx",
				"SS-inx",
				"ped4pi-inx",
				"p5-inx",
				"mariaa-inx",
				"me6p-inx",
				"medint-inx",
				"nefroi-inx",
				"neo-inx",
				"o/h ad-inx",
				"p7-inx",
				"o/h mi-inx",
				"o/hmix-inx",
				"obspol-inx",
				"p1-inx",
				"p2-inx",
				"p3-inx",
				"p4-inx",
				"o/h pe-inx",
				"lcu-inx",
				"staana-inx",
				"stagen-inx",
				"urgmix-eme",
				"urgobg-eme",
				"uxofta-eme",
				"urgmix1-eme",
				"sura-hos",
				"incare-hos",
				"urg pe-eme",
				"labext-hos",
				"uci co-inx",
				"s.part-inx",
				"santaA-hos",
				"ucipe1-icu",
				"urggy-eme",
				"quempe-icu",
				"lab-lab",
				"stacat-inx",
				"urg ad-eme",
				"c.ext1-out",
				"stalub-inx",
				"stasof-inx",
				"sur-inx",
				"transp-inx",
				"ucv-inx",
				"upm-inx",
				"urenal-out",
				"uci ad-icu",
				"uciad1-icu",
				"uciad2-icu",
				"uciad3-icu",
				"ucine-icu",
				"ucipe-icu",
				"c.ext-out",
				"uci cv-icu",
				"lacta2-inx",
				"ped3pi-inx",
				"juan-inx",
				"8p-inx",
				"aisinf-inx",
				"cortae-inx",
				"elkinr-inx",
				"ep1sur-inx",
				"ep4nor-inx",
				"7piso-inx",
				"ep4sur-inx",
				"ep5sur-inx",
				"ep6nor-inx",
				"ep7nor-inx",
				"ep8nor-inx",
				"ep9nor-inx",
				"gineco-inx",
				"ep5nor-inx",
				"7p-inx",
				"lacta1-inx",
				"6piso-inx",
				"1/2ad2-inx",
				"1/2ad3-inx",
				"1/2adu-inx",
				"1/2neo-inx",
				"1/2ped-inx",
				"2p-inx",
				"3p-inx",
				"3pte-inx",
				"4 gine-inx",
				"4piso-inx",
				"4pte-inx",
				"5 PISO-inx",
				"5p-inx",
				"5piso-inx",
				"6p-inx",
				"h1 g/o-inx",
				"h2 qx-inx",
				"6pte-inx",
				"h2s-inx",
				"hosadu-inx",
				"hoscir-inx",
				"hosmix-inx",
				"hosp3-inx",
				"hosp3n-inx",
				"hosp3s-inx",
				"hos6-inx",
				"hosp4-inx",
				"hosp5-inx",
				"hosp6-inx",
				"hosp7-inx",
				"hosp8-inx",
				"hosped-inx",
				"h2n-inx",
				"hosp4c-inx",
				"hos5-inx",
				"hosqx-inx",
				"h6-inx",
				"hos4_2-inx",
				"hos4_1-inx",
				"hos4-inx",
				"hos3-inx",
				"hos2-inx",
				"hos1-inx",
				"hos-inx",
				"h7-inx",
				"H2T2-inx",
				"hos4_3-inx",
				"h3-inx",
				"h5-inx",
				"h4-inx",
				"H3T2-inx",
				"H3T1-inx"
			]
		}
	}

with open("data.xlsx", "rb") as f:
    data = f.read()


validator_service = ValidatorService()
validator_service.validate(BytesIO(data), report)

